<?xml version="1.0" encoding="UTF-8"?>
<web-app xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://java.sun.com/xml/ns/javaee" xmlns:web="http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd" xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd" version="3.0">

  <welcome-file-list>
    <welcome-file>index.html</welcome-file>
    <welcome-file>auth.html</welcome-file>
  </welcome-file-list>

  <resource-ref>
    <description>JDBC Resource</description>
    <res-ref-name>jdbc/database</res-ref-name>
    <res-type>javax.sql.DataSource</res-type>
    <res-auth>Container</res-auth>
  </resource-ref>

  <context-param>
    <param-name>jdbc-resource</param-name>
    <param-value>jdbc/database</param-value>
  </context-param>

  <listener>
    <listener-class>com.github.jeromerocheteau.JdbcListener</listener-class>
  </listener>
  
  <filter>
    <filter-name>jdbc-filter</filter-name>
    <filter-class>com.github.jeromerocheteau.JdbcFilter</filter-class>
  </filter>
  <filter-mapping>
    <filter-name>jdbc-filter</filter-name>
    <url-pattern>/*</url-pattern>
  </filter-mapping>
  
  <filter>
    <filter-name>auth-filter</filter-name>
    <filter-class>fr.icam.emit.filters.AuthFilter</filter-class>
    <init-param>
      <param-name>landing</param-name>
      <param-value>auth.html</param-value>
    </init-param>
    <init-param>
      <param-name>filtering</param-name>
      <param-value>/account/find,/account/check</param-value>
    </init-param>
  </filter>
  <filter-mapping>
    <filter-name>auth-filter</filter-name>
    <url-pattern>/*</url-pattern>
  </filter-mapping>

  <servlet>
    <servlet-name>account-grab</servlet-name>
    <servlet-class>fr.icam.emit.servlets.AccountGrab</servlet-class>
  </servlet>
  <servlet-mapping>
    <servlet-name>account-grab</servlet-name>
    <url-pattern>/account/grab</url-pattern>
  </servlet-mapping>

  <servlet>
    <servlet-name>account-clear</servlet-name>
    <servlet-class>fr.icam.emit.servlets.AccountClear</servlet-class>
  </servlet>
  <servlet-mapping>
    <servlet-name>account-clear</servlet-name>
    <url-pattern>/account/clear</url-pattern>
  </servlet-mapping>

  <servlet>
    <servlet-name>account-find</servlet-name>
    <servlet-class>fr.icam.emit.servlets.AccountFind</servlet-class>
    <init-param>
      <param-name>sql-query</param-name>
      <param-value>/fr/icam/emit/queries/account-find.sql</param-value>
    </init-param>
  </servlet>
  <servlet-mapping>
    <servlet-name>account-find</servlet-name>
    <url-pattern>/account/find</url-pattern>
  </servlet-mapping>

  <servlet>
    <servlet-name>account-check</servlet-name>
    <servlet-class>fr.icam.emit.servlets.AccountCheck</servlet-class>
    <init-param>
      <param-name>sql-query</param-name>
      <param-value>/fr/icam/emit/queries/account-check.sql</param-value>
    </init-param>
  </servlet>
  <servlet-mapping>
    <servlet-name>account-check</servlet-name>
    <url-pattern>/account/check</url-pattern>
  </servlet-mapping>

  <servlet>
    <servlet-name>token-size</servlet-name>
    <servlet-class>fr.icam.emit.servlets.TokenSize</servlet-class>
    <init-param>
      <param-name>sql-query</param-name>
      <param-value>/fr/icam/emit/queries/token-size.sql</param-value>
    </init-param>
  </servlet>
  <servlet-mapping>
    <servlet-name>token-size</servlet-name>
    <url-pattern>/token/size</url-pattern>
  </servlet-mapping>

  <servlet>
    <servlet-name>token-page</servlet-name>
    <servlet-class>fr.icam.emit.servlets.TokenPage</servlet-class>
    <init-param>
      <param-name>sql-query</param-name>
      <param-value>/fr/icam/emit/queries/token-page.sql</param-value>
    </init-param>
  </servlet>
  <servlet-mapping>
    <servlet-name>token-page</servlet-name>
    <url-pattern>/token/page</url-pattern>
  </servlet-mapping>

  <servlet>
    <servlet-name>token-delete</servlet-name>
    <servlet-class>fr.icam.emit.servlets.TokenDelete</servlet-class>
    <init-param>
      <param-name>sql-query</param-name>
      <param-value>/fr/icam/emit/queries/token-delete.sql</param-value>
    </init-param>
  </servlet>
  <servlet-mapping>
    <servlet-name>token-delete</servlet-name>
    <url-pattern>/token/delete</url-pattern>
  </servlet-mapping>

  <servlet>
    <servlet-name>token-create</servlet-name>
    <servlet-class>fr.icam.emit.servlets.TokenCreate</servlet-class>
    <init-param>
      <param-name>sql-query</param-name>
      <param-value>/fr/icam/emit/queries/token-create.sql</param-value>
    </init-param>
  </servlet>
  <servlet-mapping>
    <servlet-name>token-create</servlet-name>
    <url-pattern>/token/create</url-pattern>
  </servlet-mapping>

  <servlet>
    <servlet-name>measurand-list</servlet-name>
    <servlet-class>fr.icam.emit.servlets.MeasurandList</servlet-class>
    <init-param>
      <param-name>sql-query</param-name>
      <param-value>/fr/icam/emit/queries/measurand-list.sql</param-value>
    </init-param>
  </servlet>
  <servlet-mapping>
    <servlet-name>measurand-list</servlet-name>
    <url-pattern>/measurand/list</url-pattern>
  </servlet-mapping>

</web-app>